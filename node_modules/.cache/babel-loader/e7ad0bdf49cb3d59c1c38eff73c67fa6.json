{"ast":null,"code":"var _jsxFileName = \"D:\\\\web\\\\textin-app\\\\src\\\\components\\\\signup.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Form from './form';\nimport { UserContext } from '../contexts/userContext';\nimport jwt_decode from \"jwt-decode\";\n\nrequire(\"dotenv\").config();\n\nexport default class Signup extends Component {\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.validateForm = this.validateForm.bind(this);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      confirmPassword: '',\n      token: \"\",\n      usererror: true,\n      passerror: false,\n      matcherror: false,\n      newUser: false\n    };\n    this.cancel = '';\n  }\n\n  validateForm() {\n    return this.state.username.length >= 5 && this.state.username.length <= 10 && this.state.password.length >= 6 && this.state.password === this.state.confirmPassword; //=======commented for testing purpose ===================//\n    //return true;\n  }\n\n  handleChange(e) {\n    var value = e.target.value;\n    var name = e.target.name;\n    this.setState({ ...this.state,\n      [name]: value\n    });\n\n    if (name === \"username\" && value.length > 4) {\n      if (this.cancel) {\n        this.cancel.cancel();\n      }\n\n      this.cancel = axios.CancelToken.source();\n      axios.get(process.env.REACT_APP_BACKEND_URL + 'api/checkusername/' + value, {\n        cancelToken: this.cancel.token\n      }).then(res => {\n        if (res.data.status === 'error') {\n          this.setState({ ...this.state,\n            usererror: true\n          });\n        } else {\n          if (value.length > 3) {\n            this.setState({ ...this.state,\n              usererror: false\n            });\n          }\n        }\n      }).catch(err => console.log(\"error\"));\n    }\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n    document.getElementById(\"submitButton\").style.pointerEvents = \"none\";\n    document.getElementById(\"submitButton\").style.opacity = \"0.35\";\n    const user = {\n      username: this.state.username,\n      password: this.state.password\n    };\n    const {\n      updatemainLoading,\n      updateId\n    } = this.context;\n    updatemainLoading(true);\n    axios.post(process.env.REACT_APP_BACKEND_URL + 'api/signup', user).then(res => {\n      updatemainLoading(false);\n      document.getElementById(\"submitButton\").style.opacity = \"1\";\n      document.getElementById(\"submitButton\").style.pointerEvents = \"auto\";\n\n      if (res.data.status === 'error') {\n        alert(\"error\");\n      } else {\n        this.setState({\n          token: res.data.token,\n          newUser: true\n        });\n        window.localStorage.setItem('token', this.state.token);\n        const decode = jwt_decode(this.state.token);\n        updateId({\n          id: decode._id,\n          username: decode.username\n        });\n      }\n    });\n    this.setState({\n      username: \"\",\n      password: \"\",\n      confirmPassword: '',\n      token: ''\n    });\n  }\n\n  render() {\n    const {\n      mainLoading\n    } = this.context;\n\n    if (mainLoading) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Form, {\n        loading: mainLoading,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 14\n        }\n      }));\n    } else return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      rootProps: this.props,\n      tog: this.props.tog,\n      loading: mainLoading,\n      stateSignup: this.state,\n      handleChange: this.handleChange,\n      handleClick: this.handleClick,\n      validateForm: this.validateForm,\n      toggle: this.props.toggle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\nSignup.contextType = UserContext;","map":{"version":3,"sources":["D:/web/textin-app/src/components/signup.js"],"names":["React","Component","axios","Form","UserContext","jwt_decode","require","config","Signup","constructor","props","handleChange","bind","handleClick","validateForm","state","username","password","confirmPassword","token","usererror","passerror","matcherror","newUser","cancel","length","e","value","target","name","setState","CancelToken","source","get","process","env","REACT_APP_BACKEND_URL","cancelToken","then","res","data","status","catch","err","console","log","preventDefault","document","getElementById","style","pointerEvents","opacity","user","updatemainLoading","updateId","context","post","alert","window","localStorage","setItem","decode","id","_id","render","mainLoading","tog","toggle","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Form from './form';\nimport  { UserContext } from '../contexts/userContext'\nimport jwt_decode from \"jwt-decode\";\nrequire(\"dotenv\").config();\n\nexport default class Signup extends Component {\n    static contextType = UserContext\n    constructor(props) {\n        super(props);\n        this.handleChange = this.handleChange.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n        this.validateForm = this.validateForm.bind(this);\n        this.state = {\n            username: \"\",\n            password: \"\",\n            confirmPassword: '',\n            token: \"\",\n            usererror: true,\n            passerror: false,\n            matcherror:false,\n            newUser:false,\n\n        }\n        this.cancel = '';\n\n    }\n   \n\n\n    validateForm() {\n\n        \n        return this.state.username.length >= 5 && this.state.username.length <= 10 && this.state.password.length >=6 && this.state.password === this.state.confirmPassword;\n    //=======commented for testing purpose ===================//\n    \n     //return true;\n    }\n\n    handleChange(e) {\n        var value = e.target.value;\n        var name = e.target.name;\n         \n        this.setState({\n            ...this.state,\n            [name]: value\n\n        })\n\n\n\n     \n        if (name === \"username\" && value.length>4) {\n            if (this.cancel) {\n                this.cancel.cancel();\n            }\n            this.cancel = axios.CancelToken.source();\n\n            axios.get(process.env.REACT_APP_BACKEND_URL+'api/checkusername/' + value, {\n                cancelToken: this.cancel.token\n            }).then(res => {\n\n                if (res.data.status === 'error') {\n                    this.setState({ ...this.state, usererror: true })\n                    \n                }\n                else {\n                    if (value.length > 3) {\n                        this.setState({ ...this.state, usererror: false })\n                    }\n                   \n\n                }\n            }).catch((err) => console.log(\"error\"))\n        }\n    };\n\n\n    handleClick(e) {\n        e.preventDefault();\n        document.getElementById(\"submitButton\").style.pointerEvents=\"none\";\n        document.getElementById(\"submitButton\").style.opacity=\"0.35\" \n        const user =\n         {\n            username: this.state.username,\n            password: this.state.password\n        }\n        const { updatemainLoading,updateId } = this.context\n          updatemainLoading(true);\n\n        axios.post(process.env.REACT_APP_BACKEND_URL+'api/signup', user)\n            .then(res => {\n                updatemainLoading(false)\n                document.getElementById(\"submitButton\").style.opacity=\"1\" \n                document.getElementById(\"submitButton\").style.pointerEvents=\"auto\" \n    \n                if (res.data.status === 'error') \n                {\n\n                   alert(\"error\")\n                }\n                else\n                 {\n\n                    this.setState({ token: res.data.token,newUser:true })\n                    window.localStorage.setItem('token', this.state.token);\n                    const decode = jwt_decode(this.state.token);\n                    updateId({id:decode._id,username:decode.username});\n                    \n                   \n                }\n            });\n\n        this.setState({\n            username: \"\",\n            password: \"\",\n            confirmPassword: '',\n            token: ''\n        });\n\n\n    }\n    render() {\n\n        const {mainLoading} = this.context\n        if(mainLoading)\n        {\n         return <div>\n             <Form loading={mainLoading}/>\n         </div>\n\n        }\n        else\n        return (\n            <div>\n                < Form rootProps={this.props} tog={this.props.tog} loading={mainLoading} stateSignup={this.state} handleChange={this.handleChange} handleClick={this.handleClick} validateForm={this.validateForm} toggle={this.props.toggle} />\n            </div>\n\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}