{"ast":null,"code":"var _jsxFileName = \"D:\\\\web\\\\textin-app\\\\src\\\\components\\\\login.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Form from './form';\nimport { UserContext } from '../contexts/userContext';\nimport jwt_decode from \"jwt-decode\";\n\nrequire(\"dotenv\").config();\n\nexport default class Login extends Component {\n  constructor(props, _context) {\n    super(props, _context);\n\n    this.check = context => {\n      const {\n        updatemainLoading\n      } = context;\n      let token = window.localStorage.getItem(\"token\");\n\n      if (token) {\n        this.props.history.push(\"/home\");\n      } else {\n        updatemainLoading(false);\n      }\n    };\n\n    this.stopAnime = () => {};\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.validateForm = this.validateForm.bind(this);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      token: \"\",\n      passerror: false\n    };\n    this.check(_context);\n  }\n\n  validateForm() {\n    return true;\n  }\n\n  handleChange(e) {\n    const name = e.target.name;\n    const value = e.target.value;\n    this.setState({ ...this.state,\n      [name]: value\n    });\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n    const {\n      updatemainLoading\n    } = this.context;\n    updatemainLoading(true);\n    const userr = {\n      username: this.state.username,\n      password: this.state.password\n    };\n    const {\n      updateId\n    } = this.context;\n    axios.post(process.env.REACT_APP_BACKEND_URL + 'api/login', userr).then(res => {\n      if (res.data.status === 'error') {\n        this.setState({\n          passerror: true\n        });\n        updatemainLoading(false);\n      } else {\n        this.setState({\n          token: this.state.token\n        });\n        window.localStorage.setItem(\"token\", res.data.token);\n        const decode = jwt_decode(res.data.token);\n        updateId({\n          id: decode._id,\n          username: decode.username\n        });\n        this.props.history.push(\"/home\");\n        this.setState({\n          username: \"\",\n          password: \"\",\n          token: \"\"\n        });\n      }\n    });\n  }\n\n  render() {\n    const {\n      mainLoading\n    } = this.context;\n\n    if (mainLoading) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Form, {\n        loading: mainLoading,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 14\n        }\n      }));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form, {\n        rootProps: this.props,\n        loading: mainLoading,\n        tog: this.props.tog,\n        stateSignup: this.state,\n        stopAnime: this.stopAnime,\n        handleChange: this.handleChange,\n        handleClick: this.handleClick,\n        validateForm: this.validateForm,\n        toggle: this.props.toggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      }));\n    }\n  }\n\n}\nLogin.contextType = UserContext;","map":{"version":3,"sources":["D:/web/textin-app/src/components/login.js"],"names":["React","Component","axios","Form","UserContext","jwt_decode","require","config","Login","constructor","props","context","check","updatemainLoading","token","window","localStorage","getItem","history","push","stopAnime","handleChange","bind","handleClick","validateForm","state","username","password","passerror","e","name","target","value","setState","preventDefault","userr","updateId","post","process","env","REACT_APP_BACKEND_URL","then","res","data","status","setItem","decode","id","_id","render","mainLoading","tog","toggle","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Form from './form';\nimport  { UserContext } from '../contexts/userContext'\nimport jwt_decode from \"jwt-decode\";\nrequire(\"dotenv\").config();\nexport default class Login extends Component {\n    static contextType = UserContext\n    constructor(props,context) {\n        super(props,context);\n\n       \n        this.handleChange = this.handleChange.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n        this.validateForm = this.validateForm.bind(this);\n\n        this.state = {\n            username: \"\",\n            password: \"\",\n            token: \"\",\n            passerror: false\n        }\n       this.check(context);\n        \n    }\n    \n    check = (context) =>\n    {\n      const { updatemainLoading} = context\n      \n     let token = window.localStorage.getItem(\"token\")\n         if(token)\n         {\n           \n         this.props.history.push(\"/home\")\n         }\n         else\n         {\n           updatemainLoading(false)\n          \n           \n         }\n         \n    }\n\n\n\n   stopAnime = () =>\n    {  \n    \n        \n    }\n\n    validateForm() {\n        return true;\n\n    }\n\n    handleChange(e) {\n\n        const name = e.target.name;\n        const value = e.target.value;\n        this.setState({\n            ...this.state,\n            [name]: value\n        })\n\n    }\n\n    handleClick(e) {\n        e.preventDefault();\n        const { updatemainLoading } = this.context\n        updatemainLoading(true);\n        const userr = {\n            username: this.state.username,\n            password: this.state.password\n        }\n       const {updateId} = this.context\n      \n        axios.post(process.env.REACT_APP_BACKEND_URL+'api/login', userr)\n            .then(res => {\n\n                    \n\n                if (res.data.status === 'error') {\n                    this.setState({ passerror: true });\n                    updatemainLoading(false);\n\n                }\n                else {\n\n                    this.setState({ token: this.state.token })\n                    window.localStorage.setItem(\"token\",res.data.token)\n                    const decode = jwt_decode(res.data.token);\n                    updateId({id:decode._id,username:decode.username});\n                  \n                    this.props.history.push(\"/home\")\n\n               \n\n                    this.setState({\n                        username: \"\",\n                        password: \"\",\n                        token: \"\"\n                    });\n\n                }\n\n\n            });\n         \n\n\n\n    }\n    render() {\n        const {mainLoading} = this.context\n        if(mainLoading)\n        {\n         return <div>\n             <Form loading={mainLoading}/>\n         </div>\n\n        }\n        else{\n        return (\n\n            <div>\n                < Form rootProps={this.props} loading={mainLoading} tog={this.props.tog} stateSignup={this.state} stopAnime={this.stopAnime} handleChange={this.handleChange} handleClick={this.handleClick} validateForm={this.validateForm} toggle={this.props.toggle} />\n            </div>\n        );\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}